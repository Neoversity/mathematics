# -*- coding: utf-8 -*-
"""–î–ó10_–ë–∞–±–µ–Ω–∫–æ–ê–Ω—Ç–æ–Ω–Ü–≤–∞–Ω–æ–≤–∏—á.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/15YAZGRzutP0V47LYGnIj1XEeh4z9qP-X

## –ß–∞—Å—Ç–∏–Ω–∞ 1. –ê–Ω–∞–ª—ñ–∑ —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö

- –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π –¥—ñ–∞–ø–∞–∑–æ–Ω–∏ –∑–Ω–∞—á–µ–Ω—å, —ó—Ö —Å–µ—Ä–µ–¥–Ω—ñ —Ç–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—é, —Ä–æ–∑–ø–æ–¥—ñ–ª–∏, –∫–æ—Ä–µ–ª—è—Ü—ñ—ó, –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å, —Ç–∏–ø–∏ –æ–∑–Ω–∞–∫.
- –ü–µ—Ä–µ–≤—ñ—Ä –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å. –ó–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∑–∞–ø–æ–≤–Ω–∏ —ó—Ö –∞–±–æ –≤–∏–¥–∞–ª–∏ —Ä—è–¥–∫–∏ –∑ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏.
- –ó–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –±—ñ–Ω–∞—Ä–Ω–∏—Ö –æ–∑–Ω–∞–∫ –∑–∞–º—ñ–Ω–∏ –∑–Ω–∞—á–µ–Ω–Ω—è —Ü–∏—Ö –æ–∑–Ω–∞–∫ –Ω–∞ 0 —Ç–∞ 1.
"""

# –Ü–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö (–ø—Ä–∏–ø—É—Å—Ç–∏–º–æ, —â–æ –≤–∞—à —Ñ–∞–π–ª –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è 'sleep_data.csv')
df = pd.read_csv('/content/Sleep_Efficiency - Sleep_Efficiency.csv')

# –û–≥–ª—è–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–∞–Ω–∏—Ö
display(df.info())
display(df.describe())

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
display(df.isnull().sum())

# –û–±—Ä–æ–±–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
# –Ø–∫—â–æ —É –≤–∞—Å —î —á–∏—Å–ª–æ–≤—ñ —Å—Ç–æ–≤–ø—Ü—ñ –∑ –ø—Ä–æ–ø—É—â–µ–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å —ó—Ö —Å–µ—Ä–µ–¥–Ω—ñ–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏
numeric_columns = df.select_dtypes(include=[np.number]).columns
df[numeric_columns] = df[numeric_columns].fillna(df[numeric_columns].mean())

# –û–±—Ä–æ–±–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö —Å—Ç–æ–≤–ø—Ü—ñ–≤
# –ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —â–æ —É –≤–∞—Å —î —Å—Ç–æ–≤–ø–µ—Ü—å 'gender' –∑ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ 'male' —Ç–∞ 'female'
# —Ç–∞ —ñ–Ω—à—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –∑ —Ç–µ–∫—Å—Ç–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ 'Yes' —Ç–∞ 'No'
df['Gender'] = df['Gender'].map({'Male': 1, 'Female': 0})
binary_columns = ['Smoking status']  # –ó–∞–º—ñ–Ω–∏ 'some_binary_column' –Ω–∞ –≤–∞—à—ñ —Å—Ç–æ–≤–ø—Ü—ñ
for col in binary_columns:
    df[col] = df[col].map({'Yes': 1, 'No': 0})

# –ü–æ–≤—Ç–æ—Ä–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö –ø—ñ—Å–ª—è –æ–±—Ä–æ–±–∫–∏
print("\n–¢–∏–ø–∏ –¥–∞–Ω–∏—Ö –ø—ñ—Å–ª—è –æ–±—Ä–æ–±–∫–∏:")
display(df.dtypes)

"""## –í–∏—Å–Ω–æ–≤–∫–∏
1. –Ø–∫—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö:

  - –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö —ñ –æ—Å–Ω–æ–≤–Ω–∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ –¥–æ–ø–æ–º–∞–≥–∞—î –æ—Ü—ñ–Ω–∏—Ç–∏ —è–∫—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö.
  - –í–∞–∂–ª–∏–≤–æ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏, —â–æ–± –¥–∞–Ω—ñ –Ω–µ –º–∞–ª–∏ –∑–Ω–∞—á–Ω–∏—Ö –∞–Ω–æ–º–∞–ª—ñ–π –∞–±–æ –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å, —è–∫—ñ –º–æ–∂—É—Ç—å –≤–ø–ª–∏–Ω—É—Ç–∏ –Ω–∞ –∞–Ω–∞–ª—ñ–∑ –∞–±–æ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è.
2. –ß–∏—Å—Ç–∫–∞ –¥–∞–Ω–∏—Ö:

  - –Ø–∫—â–æ –≤–∏—è–≤–ª–µ–Ω–æ –ø—Ä–æ–ø—É—â–µ–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤–∂–∏—Ç–∏ –∑–∞—Ö–æ–¥—ñ–≤ –¥–ª—è —ó—Ö –æ–±—Ä–æ–±–∫–∏. –¶–µ –º–æ–∂–µ –≤–∫–ª—é—á–∞—Ç–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å —Å–µ—Ä–µ–¥–Ω—ñ–º–∏ –∞–±–æ –º–µ–¥—ñ–∞–Ω–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏, –∞–±–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ä—è–¥–∫—ñ–≤ –∑ –ø—Ä–æ–ø—É—â–µ–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏.
  - –¢–∞–∫–æ–∂ –≤–∞–∂–ª–∏–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–Ω–æ–º–∞–ª—ñ–π –∞–±–æ –≤–∏–∫–∏–¥—ñ–≤, —è–∫—ñ –º–æ–∂—É—Ç—å —Å–ø–æ—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑.
3. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö –¥–ª—è –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è:

  - –ü—ñ—Å–ª—è –æ—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –º–æ–∂–Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–∏ –¥–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–∏—Ö –¥–ª—è –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è. –¶–µ –≤–∫–ª—é—á–∞—î –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö —É —á–∏—Å–ª–æ–≤—ñ, –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—é –∞–±–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü—ñ—é —á–∏—Å–ª–æ–≤–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö —ñ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –æ–∑–Ω–∞–∫, —è–∫—â–æ —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ.
4. –ü–æ–¥–∞–ª—å—à–∏–π –∞–Ω–∞–ª—ñ–∑:

  - –ü—ñ—Å–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –æ–≥–ª—è–¥—É –¥–∞–Ω–∏—Ö –º–æ–∂–Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–∏ –¥–æ –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É, —Ç–∞–∫–æ–≥–æ —è–∫ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏, –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É —Ç–∞ —ñ–Ω—à–∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ –¥–ª—è –≥–ª–∏–±—à–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è –¥–∞–Ω–∏—Ö.
"""

# –í–ø–µ–≤–Ω–∏—Ç–∏—Å—è, —â–æ –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Å—Ç–æ–≤–ø—Ü—ñ –∞–±–æ –æ–±—Ä–æ–±–ª–µ–Ω—ñ, –∞–±–æ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∫–æ—Ä–µ–ª—è—Ü—ñ—ó
numeric_df = df.select_dtypes(include=[np.number])

# –ê–Ω–∞–ª—ñ–∑ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó
correlation_matrix = numeric_df.corr()
plt.figure(figsize=(12, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm')
plt.show()

# –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –æ—á–∏—â–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö
df.to_csv('cleaned_sleep_data.csv', index=False)

"""##–°–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:
  - –ó—ñ—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —Ç–µ–ø–ª–æ–≤–æ—ó –∫–∞—Ä—Ç–∏ –¥–æ–∑–≤–æ–ª—è—î –≤–∏—è–≤–∏—Ç–∏, —è–∫—ñ –∑–º—ñ–Ω–Ω—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏—Å–æ–∫–æ –∫–æ—Ä–µ–ª—å–æ–≤–∞–Ω—ñ –∑—ñ –∑–º—ñ–Ω–Ω–æ—é "Sleep efficiency".
  - –í–∏—Å–æ–∫–∏–π –∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∏–π –∑–≤'—è–∑–æ–∫ –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –º–æ–∂–ª–∏–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏ –∑ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—é, —â–æ –º–æ–∂–µ –ø–æ—Ç—Ä–µ–±—É–≤–∞—Ç–∏ –ø–æ–¥–∞–ª—å—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –æ–±—á–∏—Å–ª–µ–Ω–Ω—è Variance Inflation Factor (VIF).

##–í–∏—Å–Ω–æ–≤–∫–∏:
1. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —á–∏—Å–ª–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö:

  - –ú–∏ –æ–±—Ä–∞–ª–∏ –ª–∏—à–µ —á–∏—Å–ª–æ–≤—ñ —Å—Ç–æ–≤–ø—Ü—ñ –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–æ—ó –º–∞—Ç—Ä–∏—Ü—ñ, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø—Ä–æ–±–ª–µ–º —ñ–∑ —Ç–µ–∫—Å—Ç–æ–≤–∏–º–∏ –∞–±–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏, —è–∫—ñ –º–æ–∂—É—Ç—å —Å–ø–æ—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏.
2. –ö–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è:

  - –ö–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è –ø–æ–∫–∞–∑—É—î —Å—Ç—É–ø—ñ–Ω—å –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É –º—ñ–∂ —á–∏—Å–ª–æ–≤–∏–º–∏ –∑–º—ñ–Ω–Ω–∏–º–∏. –í–æ–Ω–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∏—è–≤–∏—Ç–∏, —è–∫—ñ –∑–º—ñ–Ω–Ω—ñ –º–∞—é—Ç—å —Å–∏–ª—å–Ω–∏–π –ª—ñ–Ω—ñ–π–Ω–∏–π –≤–∑–∞—î–º–æ–∑–≤'—è–∑–æ–∫.
  –ó–Ω–∞—á–µ–Ω–Ω—è –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –≤–∞—Ä—ñ—é—é—Ç—å—Å—è –≤—ñ–¥ -1 (—ñ–¥–µ–∞–ª—å–Ω–∞ –Ω–µ–≥–∞—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è) –¥–æ +1 (—ñ–¥–µ–∞–ª—å–Ω–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è), –¥–µ 0 –æ–∑–Ω–∞—á–∞—î –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ª—ñ–Ω—ñ–π–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É.
3. –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–µ–ø–ª–æ–≤–æ—ó –∫–∞—Ä—Ç–∏:

  - –¢–µ–ø–ª–æ–≤–∞ –∫–∞—Ä—Ç–∞ (heatmap) –Ω–∞–¥–∞—î –∑—Ä—É—á–Ω–∏–π —Å–ø–æ—Å—ñ–± –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∏—Ö –∑–≤'—è–∑–∫—ñ–≤. –í–∏—Å–æ–∫—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è —Ç–µ–ø–ª–∏–º–∏ –∫–æ–ª—å–æ—Ä–∞–º–∏ (—á–µ—Ä–≤–æ–Ω–∏–π), –∞ –Ω–∏–∑—å–∫—ñ - —Ö–æ–ª–æ–¥–Ω–∏–º–∏ (—Å–∏–Ω—ñ–π).
  - –¶–µ –¥–æ–∑–≤–æ–ª—è—î –ª–µ–≥–∫–æ –≤–∏—è–≤–∏—Ç–∏ —Å–∏–ª—å–Ω—ñ –ø–æ–∑–∏—Ç–∏–≤–Ω—ñ –∞–±–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ñ –∑–≤'—è–∑–∫–∏ –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏.

##–ó–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏:
1. –í–∞–∂–ª–∏–≤—ñ—Å—Ç—å –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö:

  - –ü–æ–ø–µ—Ä–µ–¥–Ω—è –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö, –≤–∫–ª—é—á–∞—é—á–∏ –æ–±—Ä–æ–±–∫—É –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å —ñ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è –Ω–µ—á–∏—Å–ª–æ–≤–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö, —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ—é –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ç–æ—á–Ω–æ—Å—Ç—ñ —Ç–∞ –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ –ø–æ–¥–∞–ª—å—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É.
2. –ö–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∏–π –∞–Ω–∞–ª—ñ–∑:

  - –ö–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∏—è–≤–∏—Ç–∏ –≤–∞–∂–ª–∏–≤—ñ –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫–∏ –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏, —â–æ –º–æ–∂–µ –≤–ø–ª–∏–Ω—É—Ç–∏ –Ω–∞ –≤–∏–±—ñ—Ä –º–æ–¥–µ–ª–µ–π —ñ –º–µ—Ç–æ–¥—ñ–≤ –∞–Ω–∞–ª—ñ–∑—É.
  - –í–∏—Å–æ–∫—ñ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –º–æ–∂—É—Ç—å –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –æ–±—Ä–æ–±–∫–∏ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —à–ª—è—Ö–æ–º –≤–∏–∫–ª—é—á–µ–Ω–Ω—è –¥–µ—è–∫–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–µ—Ç–æ–¥—ñ–≤ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—ó.
3. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –æ—á–∏—â–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö:

  - –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –æ—á–∏—â–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö —É –æ–∫—Ä–µ–º–∏–π —Ñ–∞–π–ª –∑–∞–±–µ–∑–ø–µ—á—É—î –Ω–∞–¥—ñ–π–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–∏—Ö –∑–º—ñ–Ω —ñ –ø–æ–ª–µ–≥—à—É—î –ø–æ–¥–∞–ª—å—à–∏–π –∞–Ω–∞–ª—ñ–∑ –∞–±–æ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è.

–¶—ñ –≤–∏—Å–Ω–æ–≤–∫–∏ –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —è–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç–∏ –¥–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–∏—Ö, –∞–Ω–∞–ª—ñ–∑—É –∫–æ—Ä–µ–ª—è—Ü—ñ–π —ñ –æ–±—Ä–æ–±–∫–∏ –æ—á–∏—â–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—ñ —Ç–∞ –∞–Ω–∞–ª—ñ–∑—ñ.

## –ß–∞—Å—Ç–∏–Ω–∞ 2. –ú–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è

- –°—Ç–≤–æ—Ä–∏ —è–∫ –º—ñ–Ω—ñ–º—É–º 2 —Ä—ñ–∑–Ω—ñ —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó ‚ÄúSleep efficiency‚Äù .
üëâüèº –ú–æ–¥–µ–ª—ñ –≤–≤–∞–∂–∞—é—Ç—å—Å—è —Ä—ñ–∑–Ω–∏–º–∏, —è–∫—â–æ –≤–æ–Ω–∏ –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∞–±–æ —î —Ä—ñ–∑–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –º–æ–¥–µ–ª–µ–π.
- –û—Ü—ñ–Ω–∏ —è–∫—ñ—Å—Ç—å –º–æ–¥–µ–ª–µ–π —è–∫ –º—ñ–Ω—ñ–º—É–º –∑–∞ 2 –º–µ—Ç—Ä–∏–∫–∞–º–∏.
üëâüèº –û—Ü—ñ–Ω–∫–∞ –º–∞—î –±—É—Ç–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –∞–±–æ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ, –∞–±–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó.
"""

from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import mean_squared_error, r2_score

# –í–∏–¥–∞–ª–µ–Ω–Ω—è —Å—Ç–æ–≤–ø—Ü—ñ–≤ –∑ –¥–∞—Ç–∞–º–∏
df = df.drop(columns=['Bedtime', 'Wakeup time'])


# –í–∏–±—ñ—Ä —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó —Ç–∞ –æ–∑–Ω–∞–∫
X = df.drop(columns=['Sleep efficiency'])
y = df['Sleep efficiency']

# –†–æ–∑–±–∏—Ç—Ç—è –¥–∞–Ω–∏—Ö –Ω–∞ –Ω–∞–≤—á–∞–ª—å–Ω—É —Ç–∞ —Ç–µ—Å—Ç–æ–≤—É –≤–∏–±—ñ—Ä–∫–∏
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

"""## –ú–æ–¥–µ–ª—å 1: –õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è"""

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ
linear_model = LinearRegression()
linear_model.fit(X_train, y_train)

# –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ
y_pred_linear = linear_model.predict(X_test)

# –û—Ü—ñ–Ω–∫–∞ —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ
mse_linear = mean_squared_error(y_test, y_pred_linear)
r2_linear = r2_score(y_test, y_pred_linear)

print(f"–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è - MSE: {mse_linear}, R^2: {r2_linear}")

"""##–°–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:
1. –õ—ñ–Ω—ñ–π–Ω—ñ—Å—Ç—å:

  - –õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è –¥–æ–±—Ä–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –¥–∞–Ω–∏—Ö, —è–∫—ñ –º–∞—é—Ç—å –ª—ñ–Ω—ñ–π–Ω—ñ –∑–≤'—è–∑–∫–∏ –º—ñ–∂ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ —Ç–∞ —Ü—ñ–ª—å–æ–≤–æ—é –∑–º—ñ–Ω–Ω–∏–º–∏. –ü—Ä–æ—Ç–µ, —è–∫—â–æ —ñ—Å–Ω—É—é—Ç—å –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ, –º–æ–¥–µ–ª—å –º–æ–∂–µ –Ω–µ –≤–∏—è–≤–ª—è—Ç–∏—Å—è –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ç–æ—á–Ω–æ—é.
2. –ú—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å:

  - –ê–Ω–∞–ª—ñ–∑ VIF –ø–æ–∫–∞–∑–∞–≤, —â–æ –¥–µ—è–∫—ñ –æ–∑–Ω–∞–∫–∏ –º–∞—é—Ç—å –≤–∏—Å–æ–∫—É –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å, —â–æ –º–æ–∂–µ –≤–ø–ª–∏–Ω—É—Ç–∏ –Ω–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤. –¶–µ –≤–∞—Ä—Ç–æ –≤—Ä–∞—Ö—É–≤–∞—Ç–∏ –ø—Ä–∏ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.
3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –º–µ—Ç–æ–¥—ñ–≤:

  - –î–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ç–æ—á–Ω–æ—Å—Ç—ñ –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω—ñ –º–æ–¥–µ–ª—ñ, —Ç–∞–∫—ñ —è–∫ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å, —è–∫–∏–π, —è–∫ –ø–æ–∫–∞–∑–∞–ª–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏, –º–∞—î –∫—Ä–∞—â—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ (–Ω–∏–∂—á–∏–π MSE —Ç–∞ –≤–∏—â–∏–π R^2).
4. –î–æ–¥–∞—Ç–∫–æ–≤–∞ –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö:

  - –ú–æ–∂–Ω–∞ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –º–µ—Ç–æ–¥–∏ –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö, —Ç–∞–∫—ñ —è–∫ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∞–±–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è –æ–∑–Ω–∞–∫ –∑ –≤–∏—Å–æ–∫–∏–º VIF, —â–æ–± –ø–æ–∫—Ä–∞—â–∏—Ç–∏ —è–∫—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ.

## –í–∏—Å–Ω–æ–≤–∫–∏:
1. Mean Squared Error (MSE):

  - MSE –¥–ª—è –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 0.003871235807715585. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Å–µ—Ä–µ–¥–Ω—î –∫–≤–∞–¥—Ä–∞—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –≤—ñ–¥ —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —î –¥–æ—Å–∏—Ç—å –Ω–∏–∑—å–∫–∏–º, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ –º–æ–¥–µ–ª—å –¥–æ–±—Ä–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –¥–∞–Ω–∏—Ö.
2. –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –¥–µ—Ç–µ—Ä–º—ñ–Ω–∞—Ü—ñ—ó (R^2):

  - R^2 –¥–ª—è –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 0.7920709958885175. –¶–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ–∫–∞–∑—É—î, —â–æ –ø—Ä–∏–±–ª–∏–∑–Ω–æ 79.21% –≤–∞—Ä—ñ–∞—Ü—ñ—ó —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó (Sleep efficiency) –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –∑–º—ñ–Ω–Ω–∏–º–∏ –≤ –º–æ–¥–µ–ª—ñ. –¶–µ –≤–∫–∞–∑—É—î –Ω–∞ –¥–æ—Å–∏—Ç—å –≤–∏—Å–æ–∫—É –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω—É –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ.
3. –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ:

  - –ú–æ–¥–µ–ª—å –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó –≤–∏—è–≤–ª—è—î—Ç—å—Å—è –¥–æ—Å–∏—Ç—å —Ç–æ—á–Ω–æ—é –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ. –ü—Ä–æ—Ç–µ, —ñ—Å–Ω—É—î –º—ñ—Å—Ü–µ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è, –æ—Å–æ–±–ª–∏–≤–æ –ø—Ä–∏ —Ä–æ–∑–≥–ª—è–¥—ñ —ñ–Ω—à–∏—Ö –º–æ–¥–µ–ª–µ–π –∞–±–æ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö.

## –ú–æ–¥–µ–ª—å 2: –í–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å (Random Forest)
"""

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ
rf_model = RandomForestRegressor(n_estimators=100, random_state=42)
rf_model.fit(X_train, y_train)

# –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ
y_pred_rf = rf_model.predict(X_test)

# –û—Ü—ñ–Ω–∫–∞ —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ
mse_rf = mean_squared_error(y_test, y_pred_rf)
r2_rf = r2_score(y_test, y_pred_rf)

print(f"–í–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å - MSE: {mse_rf}, R^2: {r2_rf}")

"""## –°–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:
1. –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ:

  - –í–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å —î –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–æ—é –º–æ–¥–µ–ª–ª—é –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ –ª—ñ–Ω—ñ–π–Ω–æ—é —Ä–µ–≥—Ä–µ—Å—ñ—î—é, —â–æ –¥–æ–∑–≤–æ–ª—è—î –π–æ–º—É –∫—Ä–∞—â–µ –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –º—ñ–∂ –æ–∑–Ω–∞–∫–∞–º–∏ —ñ —Ü—ñ–ª—å–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ—é.
2. –ó–º–µ–Ω—à–µ–Ω–Ω—è –≤–ø–ª–∏–≤—É –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ:

  - –ú–æ–¥–µ–ª—å –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É –º–µ–Ω—à —á—É—Ç–ª–∏–≤–∞ –¥–æ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ –≤ –¥–∞–Ω–∏—Ö, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –æ–¥–Ω—ñ—î—é –∑ –ø—Ä–∏—á–∏–Ω —ó—ó –≤–∏—â–æ—ó —Ç–æ—á–Ω–æ—Å—Ç—ñ –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ –ª—ñ–Ω—ñ–π–Ω–æ—é —Ä–µ–≥—Ä–µ—Å—ñ—î—é.
3. –†–æ–∑–ø–æ–¥—ñ–ª –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫:

  - –í–∞–∂–ª–∏–≤—ñ—Å—Ç—å –æ–∑–Ω–∞–∫, –æ–±—á–∏—Å–ª–µ–Ω–∞ –¥–ª—è –º–æ–¥–µ–ª—ñ –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É, –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—ó, —è–∫—ñ –æ–∑–Ω–∞–∫–∏ –Ω–∞–π–±—ñ–ª—å—à–µ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –≤–¥–æ—Å–∫–æ–Ω–∞–ª–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ —Ç–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.
4. –ü—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö:

  - –í–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å –¥–æ–±—Ä–µ –ø—Ä–∞—Ü—é—î –Ω–∞ –≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–∏—Ö —ñ —î —Å—Ç—ñ–π–∫–∏–º –¥–æ –ø–µ—Ä–µ–Ω–∞–≤—á–∞–Ω–Ω—è –∑–∞–≤–¥—è–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é –±–∞–≥–∞—Ç—å–æ—Ö –¥–µ—Ä–µ–≤ —É –∞–Ω—Å–∞–º–±–ª—ñ.

## –í–∏—Å–Ω–æ–≤–∫–∏:
1. Mean Squared Error (MSE):

  - MSE –¥–ª—è –º–æ–¥–µ–ª—ñ –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 0.0027167827472527536. –¶–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ –º–æ–¥–µ–ª—å –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É –º–∞—î –Ω–∏–∂—á–µ —Å–µ—Ä–µ–¥–Ω—î –∫–≤–∞–¥—Ä–∞—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –≤—ñ–¥ —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ –ª—ñ–Ω—ñ–π–Ω–æ—é —Ä–µ–≥—Ä–µ—Å—ñ—î—é, —â–æ –æ–∑–Ω–∞—á–∞—î –∫—Ä–∞—â—É —Ç–æ—á–Ω—ñ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤.
2. –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –¥–µ—Ç–µ—Ä–º—ñ–Ω–∞—Ü—ñ—ó (R^2):

  - R^2 –¥–ª—è –º–æ–¥–µ–ª—ñ –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 0.8540781396220685. –¶–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ–∫–∞–∑—É—î, —â–æ –ø—Ä–∏–±–ª–∏–∑–Ω–æ 85.41% –≤–∞—Ä—ñ–∞—Ü—ñ—ó —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó (Sleep efficiency) –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –∑–º—ñ–Ω–Ω–∏–º–∏ –≤ –º–æ–¥–µ–ª—ñ. –¶–µ –≤–∫–∞–∑—É—î –Ω–∞ –≤–∏—Å–æ–∫—É –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω—É –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É.
3. –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ:

  - –ú–æ–¥–µ–ª—å –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É –≤–∏—è–≤–ª—è—î—Ç—å—Å—è –±—ñ–ª—å—à —Ç–æ—á–Ω–æ—é –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ –ª—ñ–Ω—ñ–π–Ω–æ—é —Ä–µ–≥—Ä–µ—Å—ñ—î—é.

## –û—Ü—ñ–Ω–∫–∞ —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª–µ–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
"""

# –ö—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–ª—è –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó
cv_mse_linear = -cross_val_score(linear_model, X, y, cv=5, scoring='neg_mean_squared_error').mean()
cv_r2_linear = cross_val_score(linear_model, X, y, cv=5, scoring='r2').mean()

print(f"–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è (–∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è) - MSE: {cv_mse_linear}, R^2: {cv_r2_linear}")

# –ö—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–ª—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É
cv_mse_rf = -cross_val_score(rf_model, X, y, cv=5, scoring='neg_mean_squared_error').mean()
cv_r2_rf = cross_val_score(rf_model, X, y, cv=5, scoring='r2').mean()

print(f"–í–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å (–∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è) - MSE: {cv_mse_rf}, R^2: {cv_r2_rf}")

# # –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ
# y_pred_linear = linear_model.predict(X_test)

# # –û—Ü—ñ–Ω–∫–∞ —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ
# mse_linear = mean_squared_error(y_test, y_pred_linear)
# r2_linear = r2_score(y_test, y_pred_linear)

# print(f"–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è - MSE: {mse_linear}, R^2: {r2_linear}")

# # –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ
# y_pred_rf = rf_model.predict(X_test)

# # –û—Ü—ñ–Ω–∫–∞ —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ
# mse_rf = mean_squared_error(y_test, y_pred_rf)
# r2_rf = r2_score(y_test, y_pred_rf)

# print(f"–í–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å - MSE: {mse_rf}, R^2: {r2_rf}")

"""## –ß–∞—Å—Ç–∏–Ω–∞ 3. –ê–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

- –î–ª—è –≤—Å—ñ—Ö –º–æ–¥–µ–ª–µ–π –ø–æ–±—É–¥—É–π –≥—Ä–∞—Ñ—ñ–∫–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
- –ó—Ä–æ–±–∏ –≤–∏—Å–Ω–æ–≤–∫–∏, –Ω–∞ —è–∫–∏—Ö –ø—Ä–∏–∫–ª–∞–¥–∞—Ö –∫–æ–∂–Ω–∞ –º–æ–¥–µ–ª—å –±—ñ–ª—å—à–µ –ø–æ–º–∏–ª—è—î—Ç—å—Å—è.
- –ó—Ä–æ–±–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª–µ–π. –ù–∞–ø–∏—à–∏ –≤–∏—Å–Ω–æ–≤–∫–∏.

## –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó
–ì—Ä–∞—Ñ—ñ–∫ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó –¥–æ–ø–æ–º–∞–≥–∞—î –æ—Ü—ñ–Ω–∏—Ç–∏, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —Ç–æ—á–Ω–æ –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–¥–±–∞—á–∞—î —Ü—ñ–ª—å–æ–≤—É –∑–º—ñ–Ω–Ω—É. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏ —Ç–∞ –≤–∏—Å–Ω–æ–≤–∫–∞–º–∏:
"""

# –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó
plt.figure(figsize=(12, 6))
plt.scatter(y_test, y_pred_linear, alpha=0.5, color='blue', label='–°–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è')
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], '--', color='red', label='–õ—ñ–Ω—ñ—è —ñ–¥–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑—É')
plt.xlabel('–°–ø—Ä–∞–≤–∂–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è')
plt.ylabel('–°–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è')
plt.title('–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è: –°–ø—Ä–∞–≤–∂–Ω—ñ vs. –°–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è')
plt.legend()
plt.show()

"""### –í–∏—Å–Ω–æ–≤–∫–∏ –∑ –≥—Ä–∞—Ñ—ñ–∫—É:
1. –õ—ñ–Ω—ñ—è —ñ–¥–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑—É:

  - –ß–µ—Ä–≤–æ–Ω–∞ –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞ –ª—ñ–Ω—ñ—è –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —ñ–¥–µ–∞–ª—å–Ω–∏–π –≤–∏–ø–∞–¥–æ–∫, –∫–æ–ª–∏ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–æ—á–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Å–ø—Ä–∞–≤–∂–Ω—ñ–º –∑–Ω–∞—á–µ–Ω–Ω—è–º. –Ø–∫—â–æ –≤—Å—ñ —Ç–æ—á–∫–∏ –ª–µ–∂–∞—Ç—å –Ω–∞ —Ü—ñ–π –ª—ñ–Ω—ñ—ó, –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–¥–±–∞—á–∞—î —ñ–¥–µ–∞–ª—å–Ω–æ —Ç–æ—á–Ω–æ.
2. –†–æ–∑–ø–æ–¥—ñ–ª —Ç–æ—á–æ–∫:

  - –¢–æ—á–∫–∏, —è–∫—ñ –∑–Ω–∞—á–Ω–æ –≤—ñ–¥—Ö–∏–ª—è—é—Ç—å—Å—è –≤—ñ–¥ —á–µ—Ä–≤–æ–Ω–æ—ó –ª—ñ–Ω—ñ—ó, –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ –ø–æ–º–∏–ª–∫–∏ –º–æ–¥–µ–ª—ñ. –ß–∏–º –±–ª–∏–∂—á–µ —Ç–æ—á–∫–∏ –¥–æ —á–µ—Ä–≤–æ–Ω–æ—ó –ª—ñ–Ω—ñ—ó, —Ç–∏–º —Ç–æ—á–Ω—ñ—à—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏ –º–æ–¥–µ–ª—ñ.
  - –°–∫—É–ø—á–µ–Ω–Ω—è —Ç–æ—á–æ–∫ –Ω–∞–≤–∫–æ–ª–æ —á–µ—Ä–≤–æ–Ω–æ—ó –ª—ñ–Ω—ñ—ó —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ö–æ—Ä–æ—à—É —Ç–æ—á–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ. –Ø–∫—â–æ —Ç–æ—á–∫–∏ —Ä–æ–∑–∫–∏–¥–∞–Ω—ñ –¥–∞–ª–µ–∫–æ –≤—ñ–¥ –ª—ñ–Ω—ñ—ó, —Ü–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –∑–Ω–∞—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –ø—Ä–æ–≥–Ω–æ–∑—É.
3. –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏:

  - –Ø–∫—â–æ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Ç–æ—á–æ–∫ —É –ø–µ–≤–Ω–∏–π –±—ñ–∫ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–æ–¥–µ–ª—å –ø–æ—Å—Ç—ñ–π–Ω–æ –Ω–µ–¥–æ–æ—Ü—ñ–Ω—é—î –∞–±–æ –ø–µ—Ä–µ–æ—Ü—ñ–Ω—é—î –∑–Ω–∞—á–µ–Ω–Ω—è), —Ü–µ –≤–∫–∞–∑—É—î –Ω–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –≤ –º–æ–¥–µ–ª—ñ.
4. –†–æ–∑–∫–∏–¥ –∑–Ω–∞—á–µ–Ω—å:

  - –ê–Ω–∞–ª—ñ–∑—É—é—á–∏ —Ä–æ–∑–∫–∏–¥ —Ç–æ—á–æ–∫, –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –≤–∏—Å–Ω–æ–≤–∫–∏ –ø—Ä–æ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ. –í–µ–ª–∏–∫–∏–π —Ä–æ–∑–∫–∏–¥ –º–æ–∂–µ —Å–≤—ñ–¥—á–∏—Ç–∏ –ø—Ä–æ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ —Ç–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö –º–æ–¥–µ–ª–µ–π.

###–í–∏—Å–Ω–æ–≤–∫–∏ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ:
1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥—ñ–ø–æ—Ç–µ–∑:

  - –Ø–∫—â–æ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏, —Å–ª—ñ–¥ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≥—ñ–ø–æ—Ç–µ–∑–∏ —â–æ–¥–æ –¥–∞–Ω–∏—Ö —Ç–∞ –º–æ–¥–µ–ª—ñ. –ú–æ–∂–ª–∏–≤–æ, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ –æ–∑–Ω–∞–∫–∏ –∞–±–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —ñ—Å–Ω—É—é—á—ñ.
2. –î–æ–¥–∞—Ç–∫–æ–≤–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤:

  - –ú–æ–∂–ª–∏–≤–æ, —Å–ª—ñ–¥ –ø—Ä–æ–≤–µ—Å—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—É –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—é –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–¥–µ–ª—ñ, —â–æ–± –∑–º–µ–Ω—à–∏—Ç–∏ –ø–æ—Ö–∏–±–∫–∏.
3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö –º–æ–¥–µ–ª–µ–π:

  - –Ø–∫—â–æ –ª—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è –Ω–µ –¥–∞—î –∑–∞–¥–æ–≤—ñ–ª—å–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤, –º–æ–∂–Ω–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —ñ–Ω—à—ñ –º–æ–¥–µ–ª—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å, –≥—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –±—É—Å—Ç–∏–Ω–≥ —Ç–æ—â–æ.
4. –ê–Ω–∞–ª—ñ–∑ –∑–∞–ª–∏—à–∫—ñ–≤:

  - –ê–Ω–∞–ª—ñ–∑ –∑–∞–ª–∏—à–∫—ñ–≤ –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏, –¥–µ —Å–∞–º–µ –º–æ–¥–µ–ª—å —Ä–æ–±–∏—Ç—å –Ω–∞–π–±—ñ–ª—å—à—ñ –ø–æ–º–∏–ª–∫–∏, —Ç–∞ –∑–Ω–∞–π—Ç–∏ —à–ª—è—Ö–∏ –¥–ª—è —ó—Ö –∑–º–µ–Ω—à–µ–Ω–Ω—è.

## –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É
–ì—Ä–∞—Ñ—ñ–∫ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –º–æ–¥–µ–ª—ñ –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É –¥–æ–ø–æ–º–∞–≥–∞—î –æ—Ü—ñ–Ω–∏—Ç–∏ —Ç–æ—á–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ –≤ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—ñ —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó. –û—Å—å –ø—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ —Ç–∞–∫–æ–≥–æ –≥—Ä–∞—Ñ—ñ–∫—É:
"""

# –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É
plt.figure(figsize=(12, 6))
plt.scatter(y_test, y_pred_rf, alpha=0.5, color='blue', label='–°–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è')
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], '--', color='red', label='–õ—ñ–Ω—ñ—è —ñ–¥–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑—É')
plt.xlabel('–°–ø—Ä–∞–≤–∂–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è')
plt.ylabel('–°–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è')
plt.title('–í–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å: –°–ø—Ä–∞–≤–∂–Ω—ñ vs. –°–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è')
plt.legend()
plt.show()

"""### –í–∏—Å–Ω–æ–≤–∫–∏ –∑ –≥—Ä–∞—Ñ—ñ–∫—É:
1. –õ—ñ–Ω—ñ—è —ñ–¥–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑—É:

  - –ß–µ—Ä–≤–æ–Ω–∞ –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞ –ª—ñ–Ω—ñ—è –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —ñ–¥–µ–∞–ª—å–Ω–∏–π –≤–∏–ø–∞–¥–æ–∫, –∫–æ–ª–∏ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–æ—á–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Å–ø—Ä–∞–≤–∂–Ω—ñ–º –∑–Ω–∞—á–µ–Ω–Ω—è–º. –¢–æ—á–∫–∏, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –Ω–∞ —Ü—ñ–π –ª—ñ–Ω—ñ—ó, –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Ç–æ—á–Ω—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏ –º–æ–¥–µ–ª—ñ.
2. –†–æ–∑–ø–æ–¥—ñ–ª —Ç–æ—á–æ–∫:

  - –Ø–∫—â–æ —Ç–æ—á–∫–∏ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –±–ª–∏–∑—å–∫–æ –¥–æ —á–µ—Ä–≤–æ–Ω–æ—ó –ª—ñ–Ω—ñ—ó, —Ü–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ö–æ—Ä–æ—à—É —Ç–æ—á–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ. –¢–æ—á–∫–∏, —â–æ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –¥–∞–ª–µ–∫–æ –≤—ñ–¥ –ª—ñ–Ω—ñ—ó, —Å–≤—ñ–¥—á–∞—Ç—å –ø—Ä–æ –∑–Ω–∞—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –ø—Ä–æ–≥–Ω–æ–∑—É.
3. –†–æ–∑–∫–∏–¥ —Ç–æ—á–æ–∫:

  - –í–µ–ª–∏–∫–∏–π —Ä–æ–∑–∫–∏–¥ —Ç–æ—á–æ–∫ –≤—ñ–¥ —á–µ—Ä–≤–æ–Ω–æ—ó –ª—ñ–Ω—ñ—ó –º–æ–∂–µ —Å–≤—ñ–¥—á–∏—Ç–∏ –ø—Ä–æ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ. –°–∫—É–ø—á–µ–Ω–Ω—è —Ç–æ—á–æ–∫ –Ω–∞–≤–∫–æ–ª–æ –ª—ñ–Ω—ñ—ó –≤–∫–∞–∑—É—î –Ω–∞ –±—ñ–ª—å—à —Å—Ç–∞–±—ñ–ª—å–Ω—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏.
4. –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏:

  - –Ø–∫—â–æ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤—Å—ñ —Ç–æ—á–∫–∏ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –≤–∏—â–µ –∞–±–æ –Ω–∏–∂—á–µ —á–µ—Ä–≤–æ–Ω–æ—ó –ª—ñ–Ω—ñ—ó), —Ü–µ –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω–æ—ó –ø–æ–º–∏–ª–∫–∏ –≤ –º–æ–¥–µ–ª—ñ.
5. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –ª—ñ–Ω—ñ–π–Ω–æ—é —Ä–µ–≥—Ä–µ—Å—ñ—î—é:

  - –ú–æ–∂–Ω–∞ –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ —Ü–µ–π –≥—Ä–∞—Ñ—ñ–∫ –∑ –≥—Ä–∞—Ñ—ñ–∫–æ–º –¥–ª—è –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó, —â–æ–± –æ—Ü—ñ–Ω–∏—Ç–∏, —è–∫–∞ –º–æ–¥–µ–ª—å –¥–∞—î –±—ñ–ª—å—à —Ç–æ—á–Ω—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏. –Ø–∫—â–æ —Ç–æ—á–∫–∏ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É –¥–ª—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –±–ª–∏–∂—á–µ –¥–æ —á–µ—Ä–≤–æ–Ω–æ—ó –ª—ñ–Ω—ñ—ó –≤ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—ñ –∑ –ª—ñ–Ω—ñ–π–Ω–æ—é —Ä–µ–≥—Ä–µ—Å—ñ—î—é, —Ü–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –∫—Ä–∞—â—É —Ç–æ—á–Ω—ñ—Å—Ç—å –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É.

###–í–∏—Å–Ω–æ–≤–∫–∏ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ:
1. –ü–æ–¥–∞–ª—å—à–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤:

  - –Ø–∫—â–æ –º–æ–¥–µ–ª—å –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É –ø–æ–∫–∞–∑—É—î —Ö–æ—Ä–æ—à—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏, –º–æ–∂–Ω–∞ –ø—Ä–æ–≤–µ—Å—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—É –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—é –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ç–æ—á–Ω–æ—Å—Ç—ñ.
2. –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –æ–∑–Ω–∞–∫:

  - –ú–æ–∂–ª–∏–≤–æ, –≤–∞—Ä—Ç–æ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ –æ–∑–Ω–∞–∫–∏ –∞–±–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —ñ—Å–Ω—É—é—á—ñ, —â–æ–± –ø—ñ–¥–≤–∏—â–∏—Ç–∏ —Ç–æ—á–Ω—ñ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤.
3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–Ω—Å–∞–º–±–ª—ñ–≤ –º–æ–¥–µ–ª–µ–π:

  - –Ø–∫—â–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—Å–µ —â–µ –Ω–µ–∑–∞–¥–æ–≤—ñ–ª—å–Ω–∏–π, –º–æ–∂–Ω–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∞–Ω—Å–∞–º–±–ª—ñ –º–æ–¥–µ–ª–µ–π, –∫–æ–º–±—ñ–Ω—É—é—á–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä—ñ–∑–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ç–æ—á–Ω–æ—Å—Ç—ñ.
4. –ê–Ω–∞–ª—ñ–∑ –∑–∞–ª–∏—à–∫—ñ–≤:

  - –ê–Ω–∞–ª—ñ–∑ –∑–∞–ª–∏—à–∫—ñ–≤ –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –æ–±–ª–∞—Å—Ç—ñ, –¥–µ –º–æ–¥–µ–ª—å –Ω–∞–π–±—ñ–ª—å—à–µ –ø–æ–º–∏–ª—è—î—Ç—å—Å—è, —Ç–∞ –∑–Ω–∞–π—Ç–∏ —à–ª—è—Ö–∏ –¥–ª—è —ó—Ö –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è.
"""

# –í–∏—Å–Ω–æ–≤–∫–∏
display(f"–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è - MSE: {mse_linear}, R^2: {r2_linear}")
display(f"–í–∏–ø–∞–¥–∫–æ–≤–∏–π –ª—ñ—Å - MSE: {mse_rf}, R^2: {r2_rf}")

# –ê–Ω–∞–ª—ñ–∑ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤, –¥–µ –º–æ–¥–µ–ª—å –±—ñ–ª—å—à–µ –ø–æ–º–∏–ª—è—î—Ç—å—Å—è
errors_linear = abs(y_test - y_pred_linear)
errors_rf = abs(y_test - y_pred_rf)

# –ù–∞–π–±—ñ–ª—å—à—ñ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó
max_errors_linear = errors_linear.nlargest(5)
display("–ù–∞–π–±—ñ–ª—å—à—ñ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó:")
display(df.loc[max_errors_linear.index])

# –ù–∞–π–±—ñ–ª—å—à—ñ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É
max_errors_rf = errors_rf.nlargest(5)
display("–ù–∞–π–±—ñ–ª—å—à—ñ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É:")
display(df.loc[max_errors_rf.index])

"""### –ó–∞–≥–∞–ª—å–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫:
- –ü—ñ–¥—Å—É–º–æ–≤—É—é—á–∏, –≥—Ä–∞—Ñ—ñ–∫ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å —î –≤–∞–∂–ª–∏–≤–∏–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –æ–±–ª–∞—Å—Ç–µ–π –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è.
- –ì—Ä–∞—Ñ—ñ–∫ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö —Ç–∞ —Å–ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –º–æ–¥–µ–ª—ñ –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É —î –≤–∞–∂–ª–∏–≤–∏–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –æ–±–ª–∞—Å—Ç–µ–π –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è. –í—ñ–Ω –¥–æ–∑–≤–æ–ª—è—î –≤—ñ–∑—É–∞–ª—å–Ω–æ –æ—Ü—ñ–Ω–∏—Ç–∏, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –¥–æ–±—Ä–µ –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–¥–±–∞—á–∞—î —Ü—ñ–ª—å–æ–≤—É –∑–º—ñ–Ω–Ω—É, —Ç–∞ –≤–∏—è–≤–∏—Ç–∏ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –æ–±–ª–∞—Å—Ç—ñ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ—ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó.

# –î–ª—è —Ç–∏—Ö, —Ö—Ç–æ —Ö–æ—á–µ –∑—Ä–æ–±–∏—Ç–∏ –±—ñ–ª—å—à–µ -->

## –û–∑–Ω–∞–∫–∏ –Ω–∞ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å (Variance inflation factor).

–ê–Ω–∞–ª—ñ–∑ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Variance Inflation Factor (VIF) –¥–æ–∑–≤–æ–ª—è—î –æ—Ü—ñ–Ω–∏—Ç–∏, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —Å–∏–ª—å–Ω–æ –∫–æ–∂–Ω–∞ –æ–∑–Ω–∞–∫–∞ –∫–æ—Ä–µ–ª—é—î –∑ —ñ–Ω—à–∏–º–∏ –æ–∑–Ω–∞–∫–∞–º–∏ —É –º–æ–¥–µ–ª—ñ. –¶–µ –≤–∞–∂–ª–∏–≤–æ –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ, —è–∫—ñ –º–æ–∂—É—Ç—å –≤–ø–ª–∏–Ω—É—Ç–∏ –Ω–∞ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å —Ç–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—é —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π.
"""

from statsmodels.stats.outliers_influence import variance_inflation_factor

# –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é—á–∏, —â–æ df - —Ü–µ –≤–∞—à DataFrame –∑ –æ–∑–Ω–∞–∫–∞–º–∏ –º–æ–¥–µ–ª—ñ
# –ó–∞–º—ñ–Ω—ñ—Ç—å df –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω–∏–π DataFrame –∑ –æ–∑–Ω–∞–∫–∞–º–∏

# –í–∏–±–µ—Ä—ñ—Ç—å —Ç—ñ–ª—å–∫–∏ –∫—ñ–ª—å–∫—ñ—Å–Ω—ñ –æ–∑–Ω–∞–∫–∏ –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è VIF
numerical_features = df.select_dtypes(include=['float64', 'int64'])

# –û–±—á–∏—Å–ª—é—î–º–æ VIF –¥–ª—è –∫–æ–∂–Ω–æ—ó –æ–∑–Ω–∞–∫–∏
vif_data = pd.DataFrame()
vif_data["feature"] = numerical_features.columns
vif_data["VIF"] = [variance_inflation_factor(numerical_features.values, i) for i in range(len(numerical_features.columns))]

print(vif_data)

"""##–í–∏—Å–Ω–æ–≤–∫–∏:
1. –í–∏—Å–æ–∫–∏–π VIF –¥–ª—è Deep Sleep Percentage (114.50):

  - –ó–Ω–∞—á–µ–Ω–Ω—è VIF –∑–Ω–∞—á–Ω–æ –≤–∏—â–µ 10, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Å–∏–ª—å–Ω—É –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Ü—è –æ–∑–Ω–∞–∫–∞ —Å–∏–ª—å–Ω–æ –∫–æ—Ä–µ–ª—é—î –∑ —ñ–Ω—à–∏–º–∏ –æ–∑–Ω–∞–∫–∞–º–∏ —ñ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ.
2. –í–∏—Å–æ–∫–∏–π VIF –¥–ª—è REM Sleep Percentage (49.24):

  - –¶—è –æ–∑–Ω–∞–∫–∞ —Ç–∞–∫–æ–∂ –º–∞—î –≤–∏—Å–æ–∫–∏–π VIF, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å. –í–∞—Ä—Ç–æ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ —ó—ó –∫–æ—Ä–µ–ª—è—Ü—ñ—é –∑ —ñ–Ω—à–∏–º–∏ –æ–∑–Ω–∞–∫–∞–º–∏.
3. –í–∏—Å–æ–∫–∏–π VIF –¥–ª—è Light Sleep Percentage (18.39):

  - –•–æ—á–∞ VIF –Ω–∏–∂—á–∏–π, –Ω—ñ–∂ –¥–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –¥–≤–æ—Ö –æ–∑–Ω–∞–∫, –≤—ñ–Ω –≤—Å–µ –∂ —Ç–∞–∫–∏ –ø–µ—Ä–µ–≤–∏—â—É—î –ø–æ—Ä—ñ–≥ 10, —â–æ —Ç–∞–∫–æ–∂ –≤–∫–∞–∑—É—î –Ω–∞ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å.
4. –ü–æ–º—ñ—Ä–Ω–∏–π VIF –¥–ª—è Sleep Efficiency (5.11):

  - –ó–Ω–∞—á–µ–Ω–Ω—è VIF –¥–ª—è —Ü—ñ—î—ó –æ–∑–Ω–∞–∫–∏ –ø–µ—Ä–µ–≤–∏—â—É—î 5, –∞–ª–µ –Ω–∏–∂—á–µ 10. –¶–µ –≤–∫–∞–∑—É—î –Ω–∞ –ø–æ–º—ñ—Ä–Ω—É –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å, —è–∫–∞ –Ω–µ —î –∫—Ä–∏—Ç–∏—á–Ω–æ—é, –∞–ª–µ –≤–∞—Ä—Ç–æ –∑–≤–µ—Ä–Ω—É—Ç–∏ —É–≤–∞–≥—É.
5. –ù–∏–∑—å–∫–∏–π VIF –¥–ª—è —ñ–Ω—à–∏—Ö –æ–∑–Ω–∞–∫ (–±–ª–∏–∑—å–∫–æ 1):

  - –î–ª—è —Ä–µ—à—Ç–∏ –æ–∑–Ω–∞–∫ –∑–Ω–∞—á–µ–Ω–Ω—è VIF –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ –≤—ñ–¥ 1 –¥–æ 2, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –Ω–∏–∑—å–∫–∏–π —Ä—ñ–≤–µ–Ω—å –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ. –¶—ñ –æ–∑–Ω–∞–∫–∏ –Ω–µ —î –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–∏–º–∏ –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ.

##–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:
1. –í–∏–¥–∞–ª–µ–Ω–Ω—è –∞–±–æ –æ–±'—î–¥–Ω–∞–Ω–Ω—è –æ–∑–Ω–∞–∫ –∑ –≤–∏—Å–æ–∫–∏–º VIF:

  - –†–æ–∑–≥–ª—è–Ω—å—Ç–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∞–±–æ –æ–±'—î–¥–Ω–∞–Ω–Ω—è –æ–∑–Ω–∞–∫ –∑ –≤–∏—Å–æ–∫–∏–º VIF (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Deep Sleep Percentage, REM Sleep Percentage), —â–æ–± –∑–Ω–∏–∑–∏—Ç–∏ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å. –ú–æ–∂–Ω–∞ –ø—Ä–æ–≤–µ—Å—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫–∞ –∑ –æ–∑–Ω–∞–∫ –º–∞—î –Ω–∞–π–±—ñ–ª—å—à–∏–π –≤–ø–ª–∏–≤ –Ω–∞ –º–æ–¥–µ–ª—å —ñ —è–∫–∞ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–∞.
2. –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–∑–Ω–∞–∫:

  - –ú–æ–∂–Ω–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –æ–∑–Ω–∞–∫–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é PCA - Principal Component Analysis), —â–æ–± –∑–º–µ–Ω—à–∏—Ç–∏ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å.
3. –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—è:

  - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–µ—Ç–æ–¥—ñ–≤ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—ó, —Ç–∞–∫–∏—Ö —è–∫ Lasso –∞–±–æ Ridge —Ä–µ–≥—Ä–µ—Å—ñ—è, –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∑–º–µ–Ω—à–∏—Ç–∏ –≤–ø–ª–∏–≤ –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–∏—Ö –æ–∑–Ω–∞–∫ –Ω–∞ –º–æ–¥–µ–ª—å.

##–ó–∞–≥–∞–ª—å–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫:

  –ê–Ω–∞–ª—ñ–∑ VIF –≤–∫–∞–∑—É—î –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ —Å–µ—Ä–µ–¥ –¥–µ—è–∫–∏—Ö –æ–∑–Ω–∞–∫. –í–∏—Å–æ–∫—ñ –∑–Ω–∞—á–µ–Ω–Ω—è VIF –º–æ–∂—É—Ç—å –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø—Ä–æ–±–ª–µ–º –∑ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—î—é –º–æ–¥–µ–ª—ñ —Ç–∞ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–∏–º–∏ –æ—Ü—ñ–Ω–∫–∞–º–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤. –ó–Ω–∏–∂–µ–Ω–Ω—è –º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ —á–µ—Ä–µ–∑ –≤–∏–¥–∞–ª–µ–Ω–Ω—è, –æ–±'—î–¥–Ω–∞–Ω–Ω—è –∞–±–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–∑–Ω–∞–∫ –º–æ–∂–µ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ —è–∫—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ —Ç–∞ –∑—Ä–æ–±–∏—Ç–∏ —ó—ó –±—ñ–ª—å—à —Å—Ç–∞–±—ñ–ª—å–Ω–æ—é.

# –û–ø—Ç–∏–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–¥–µ–ª–µ–π, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∞–ª–≥–æ—Ä–∏—Ç–º—É GridSearch.

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è GridSearchCV –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–¥–µ–ª—ñ –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É –¥–æ–∑–≤–æ–ª—è—î –∑–Ω–∞–π—Ç–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å –Ω–∞–π–∫—Ä–∞—â—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ. –¶–µ –≤–∞–∂–ª–∏–≤–∏–π –µ—Ç–∞–ø —É –ø—Ä–æ—Ü–µ—Å—ñ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –¥–æ–ø–æ–º–∞–≥–∞—î –ø—ñ–¥–≤–∏—â–∏—Ç–∏ —Ç–æ—á–Ω—ñ—Å—Ç—å —Ç–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤.
"""

from sklearn.model_selection import GridSearchCV
from sklearn.ensemble import RandomForestRegressor

# –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ
rf_model = RandomForestRegressor(random_state=42)

# –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, —è–∫—ñ –±—É–¥–µ–º–æ –ø–µ—Ä–µ–±–∏—Ä–∞—Ç–∏
param_grid_rf = {
    'n_estimators': [100, 200, 300],
    'max_depth': [None, 10, 20],
    'min_samples_split': [2, 5, 10],
    'min_samples_leaf': [1, 2, 4]
}

# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è GridSearch –¥–ª—è –ø–æ—à—É–∫—É –æ–ø—Ç–∏–º–∞–ª—å–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
grid_search_rf = GridSearchCV(estimator=rf_model, param_grid=param_grid_rf,
                              scoring='neg_mean_squared_error', cv=5, verbose=1, n_jobs=-1)
grid_search_rf.fit(X_train, y_train)

# –í–∏–≤–µ–¥–µ–Ω–Ω—è –∫—Ä–∞—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
print("–ö—Ä–∞—â—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É:", grid_search_rf.best_params_)
print("–ù–∞–π–∫—Ä–∞—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (MSE) –¥–ª—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É:", -grid_search_rf.best_score_)

"""### –í–∏—Å–Ω–æ–≤–∫–∏:
1. –ó–Ω–∞—á–µ–Ω–Ω—è –∫—Ä–∞—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤:

  - –û–ø—Ç–∏–º–∞–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –∑–Ω–∞–π–¥–µ–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é GridSearchCV, —î –Ω–∞–π–∫—Ä–∞—â–∏–º–∏ –¥–ª—è –¥–∞–Ω–æ—ó –º–æ–¥–µ–ª—ñ —Ç–∞ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—ñ–¥–≤–∏—â–∏—Ç–∏ —Ç–æ—á–Ω—ñ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
    - n_estimators: –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–µ—Ä–µ–≤ —É –≤–∏–ø–∞–¥–∫–æ–≤–æ–º—É –ª—ñ—Å—ñ.
    - max_depth: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –≥–ª–∏–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞.
    - min_samples_split: –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑—Ä–∞–∑–∫—ñ–≤, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –¥–ª—è –ø–æ–¥—ñ–ª—É –≤—É–∑–ª–∞.
    - min_samples_leaf: –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑—Ä–∞–∑–∫—ñ–≤ —É –ª–∏—Å—Ç–æ–≤–æ–º—É –≤—É–∑–ª—ñ.
2. –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ:

  - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è GridSearchCV –¥–æ–ø–æ–º–æ–≥–ª–æ –∑–Ω–∞–π—Ç–∏ –Ω–∞–π–∫—Ä–∞—â—É –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—é –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, —è–∫–∞ –∑–∞–±–µ–∑–ø–µ—á–∏–ª–∞ –Ω–∞–π–º–µ–Ω—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è MSE (Mean Squared Error) –Ω–∞ –∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó. –¶–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ –º–æ–¥–µ–ª—å —Å—Ç–∞–ª–∞ –±—ñ–ª—å—à —Ç–æ—á–Ω–æ—é —É —Å–≤–æ—ó—Ö –ø—Ä–æ–≥–Ω–æ–∑–∞—Ö.
3. –ó–Ω–∏–∂–µ–Ω–Ω—è —Ä–∏–∑–∏–∫—É –ø–µ—Ä–µ–Ω–∞–≤—á–∞–Ω–Ω—è:

  - –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–¥–µ–ª—ñ –¥–æ–ø–æ–º–∞–≥–∞—î —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–µ—Ä–µ–Ω–∞–≤—á–∞–Ω–Ω—è (overfitting), –∫–æ–ª–∏ –º–æ–¥–µ–ª—å –∑–∞–Ω–∞–¥—Ç–æ —Ç–æ—á–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–æ –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö, –∞–ª–µ –ø–æ–∫–∞–∑—É—î –ø–æ–≥–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö. –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π –≤–∏–±—ñ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–æ–∑–≤–æ–ª—è—î –º–æ–¥–µ–ª—ñ –∫—Ä–∞—â–µ —É–∑–∞–≥–∞–ª—å–Ω—é–≤–∞—Ç–∏ –Ω–∞ –Ω–æ–≤—ñ –¥–∞–Ω—ñ.
4. –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤:

  - –ó–∞–≤–¥—è–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é –∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó (5-fold cross-validation), —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ GridSearchCV —î –Ω–∞–¥—ñ–π–Ω–∏–º–∏ —ñ —Å—Ç—ñ–π–∫–∏–º–∏. –¶–µ –∑–∞–±–µ–∑–ø–µ—á—É—î –±—ñ–ª—å—à —Å—Ç–∞–±—ñ–ª—å–Ω—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏ –Ω–∞ –Ω–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.
5. –ó–Ω–∞—á–µ–Ω–Ω—è MSE:

  - –ù–∞–π–∫—Ä–∞—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (MSE) –ø–æ–∫–∞–∑—É—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —Ç–æ—á–Ω–æ –º–æ–¥–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑—É—î —Ü—ñ–ª—å–æ–≤—É –∑–º—ñ–Ω–Ω—É. –ó–º–µ–Ω—à–µ–Ω–Ω—è MSE –≤–∫–∞–∑—É—î –Ω–∞ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –Ω–∞–π–∫—Ä–∞—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç MSE –¥–ª—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É —Å–∫–ª–∞–≤ 0.002, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Å–µ—Ä–µ–¥–Ω—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞ –º—ñ–∂ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏–º–∏ —Ç–∞ —Ñ–∞–∫—Ç–∏—á–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ —î –¥–æ—Å–∏—Ç—å –º–∞–ª–æ—é, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –≤–∏—Å–æ–∫—É —Ç–æ—á–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ.

### –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏:
1. –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤:

  - –í–∞–∂–ª–∏–≤–æ –ø—Ä–æ–≤–æ–¥–∏—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è –±—É–¥—å-—è–∫–æ—ó –º–æ–¥–µ–ª—ñ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è, —â–æ–± –¥–æ—Å—è–≥—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–∞ —Ç–æ—á–Ω–æ—Å—Ç—ñ.
2. –ê–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤:

  - –ê–Ω–∞–ª—ñ–∑—É—é—á–∏ –Ω–∞–π–∫—Ä–∞—â—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ GridSearchCV, –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –≤–∏—Å–Ω–æ–≤–∫–∏ –ø—Ä–æ —Ç–µ, —è–∫—ñ –∞—Å–ø–µ–∫—Ç–∏ –º–æ–¥–µ–ª—ñ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ç–∞ —è–∫ —Ä—ñ–∑–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.
3. –ü–æ–¥–∞–ª—å—à–µ –≤–¥–æ—Å–∫–æ–Ω–∞–ª–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ:

  - –ù–∞ –æ—Å–Ω–æ–≤—ñ –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –º–æ–∂–Ω–∞ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –≤–¥–æ—Å–∫–æ–Ω–∞–ª–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ–¥–∞—Ç–∫–æ–≤–æ –æ–ø—Ç–∏–º—ñ–∑—É—é—á–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∞–±–æ –ø—Ä–æ–±—É—é—á–∏ —ñ–Ω—à—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ.

# –ê–Ω–∞–ª—ñ–∑ –≤–∞–∂–ª–∏–≤—ñ—Å—Ç—å –æ–∑–Ω–∞–∫ (feature importance).

–ê–Ω–∞–ª—ñ–∑ –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫ –¥–æ–∑–≤–æ–ª—è—î –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —è–∫—ñ –∑ –Ω–∏—Ö –º–∞—é—Ç—å –Ω–∞–π–±—ñ–ª—å—à–∏–π –≤–ø–ª–∏–≤ –Ω–∞ –º–æ–¥–µ–ª—å. –¶–µ –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ —É –≤–¥–æ—Å–∫–æ–Ω–∞–ª–µ–Ω–Ω—ñ –º–æ–¥–µ–ª—ñ, –∞ —Ç–∞–∫–æ–∂ —É –∫—Ä–∞—â–æ–º—É —Ä–æ–∑—É–º—ñ–Ω–Ω—ñ –¥–∞–Ω–∏—Ö.
"""

import seaborn as sns

# –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫
feature_importance = grid_search_rf.best_estimator_.feature_importances_

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è DataFrame –∑ –≤–∞–∂–ª–∏–≤—ñ—Å—Ç—é –æ–∑–Ω–∞–∫
feature_importance_df = pd.DataFrame({'feature': X.columns, 'importance': feature_importance})

# –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –æ–∑–Ω–∞–∫ –∑–∞ —ó—Ö –≤–∞–∂–ª–∏–≤—ñ—Å—Ç—é —É —Å–ø–∞–¥–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É
feature_importance_df = feature_importance_df.sort_values(by='importance', ascending=False).reset_index(drop=True)

# –í–∏–≤—ñ–¥ —Ç–æ–ø-10 –Ω–∞–π–±—ñ–ª—å—à –≤–∞–∂–ª–∏–≤–∏—Ö –æ–∑–Ω–∞–∫
print(feature_importance_df.head(10))

# –ü–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ—ñ–∫—É –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–∑–Ω–∞–∫
plt.figure(figsize=(12, 8))
sns.barplot(x='importance', y='feature', data=feature_importance_df.head(10), orient='h', palette='viridis')
plt.title('Top 10 Feature Importances')
plt.xlabel('Importance')
plt.ylabel('Feature')
plt.show()

# –í–∏–≤—ñ–¥ —Ç–æ–ø-10 –Ω–∞–π–±—ñ–ª—å—à –≤–∞–∂–ª–∏–≤–∏—Ö –æ–∑–Ω–∞–∫
display(feature_importance_df.head(10))

"""### –í–∏—Å–Ω–æ–≤–∫–∏:
1. –ù–∞–π–±—ñ–ª—å—à –≤–∞–∂–ª–∏–≤—ñ –æ–∑–Ω–∞–∫–∏:

  - –ó –≥—Ä–∞—Ñ—ñ–∫—É —Ç–∞ —Ç–∞–±–ª–∏—Ü—ñ –≤–∏–¥–Ω–æ, —â–æ –Ω–∞–π–±—ñ–ª—å—à–∏–π –≤–ø–ª–∏–≤ –Ω–∞ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è "Sleep efficiency" –º–∞—é—Ç—å –Ω–∞—Å—Ç—É–ø–Ω—ñ –æ–∑–Ω–∞–∫–∏:
    1. Light sleep percentage
    2. Deep sleep percentage
    3. Awakenings
    4. Age
    5. Smoking status
    6. Gender
    7. Alcohol consumption
    8. REM sleep percentage
    9. Exercise frequency
    10. Caffeine consumption
2. –§—ñ–∑—ñ–æ–ª–æ–≥—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Å–Ω—É:

  - –í—ñ–¥—Å–æ—Ç–æ–∫ –≥–ª–∏–±–æ–∫–æ–≥–æ —Å–Ω—É (Deep sleep percentage), –≤—ñ–¥—Å–æ—Ç–æ–∫ REM-—Å–Ω—É (REM sleep percentage) —Ç–∞ –≤—ñ–¥—Å–æ—Ç–æ–∫ –ª–µ–≥–∫–æ–≥–æ —Å–Ω—É (Light sleep percentage) —î –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–º–∏ –æ–∑–Ω–∞–∫–∞–º–∏. –¶–µ –ª–æ–≥—ñ—á–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ —è–∫—ñ—Å—Ç—å —Å–Ω—É.
3. Awakenings (–ü—Ä–æ–±—É–¥–∂–µ–Ω–Ω—è):

  - –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–±—É–¥–∂–µ–Ω—å —Ç–∞–∫–æ–∂ –º–∞—î –∑–Ω–∞—á–Ω–∏–π –≤–ø–ª–∏–≤. –ë—ñ–ª—å—à–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–±—É–¥–∂–µ–Ω—å –º–æ–∂–µ —Å–≤—ñ–¥—á–∏—Ç–∏ –ø—Ä–æ –ø–æ—Ä—É—à–µ–Ω–Ω—è —Å–Ω—É, —â–æ –∑–Ω–∏–∂—É—î –π–æ–≥–æ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.
4. –°–æ—Ü—ñ–∞–ª—å–Ω–æ-–¥–µ–º–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ —Ñ–∞–∫—Ç–æ—Ä–∏:

  - –í—ñ–∫ —Ç–∞ —Å—Ç–∞—Ç—å —Ç–∞–∫–æ–∂ –º–∞—é—Ç—å –≤–ø–ª–∏–≤, —Ö–æ—á–∞ —ñ –º–µ–Ω—à–∏–π –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ —Ñ—ñ–∑—ñ–æ–ª–æ–≥—ñ—á–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Å–Ω—É. –¶–µ –º–æ–∂–µ —Å–≤—ñ–¥—á–∏—Ç–∏ –ø—Ä–æ —Ç–µ, —â–æ —Ä—ñ–∑–Ω—ñ –≤—ñ–∫–æ–≤—ñ –≥—Ä—É–ø–∏ —Ç–∞ —Å—Ç–∞—Ç—ñ –º–∞—é—Ç—å —Ä—ñ–∑–Ω—ñ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç—ñ —Å–Ω—É.
5. –®–∫—ñ–¥–ª–∏–≤—ñ –∑–≤–∏—á–∫–∏ —Ç–∞ —Ñ—ñ–∑–∏—á–Ω–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:

  - –í–∂–∏–≤–∞–Ω–Ω—è –∞–ª–∫–æ–≥–æ–ª—é —Ç–∞ –ø–∞–ª—ñ–Ω–Ω—è –º–∞—é—Ç—å –ø–æ–º—ñ—Ç–Ω–∏–π –≤–ø–ª–∏–≤ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Å–Ω—É. –¶–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è–º, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü—ñ —Ñ–∞–∫—Ç–æ—Ä–∏ –º–æ–∂—É—Ç—å –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ –≤–ø–ª–∏–≤–∞—Ç–∏ –Ω–∞ —è–∫—ñ—Å—Ç—å —Å–Ω—É. –ß–∞—Å—Ç–æ—Ç–∞ —Ñ—ñ–∑–∏—á–Ω–∏—Ö –≤–ø—Ä–∞–≤ —Ç–∞–∫–æ–∂ –≤–∞–∂–ª–∏–≤–∞, –æ—Å–∫—ñ–ª—å–∫–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ñ —Ñ—ñ–∑–∏—á–Ω—ñ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–∂—É—Ç—å –ø–æ–∫—Ä–∞—â–∏—Ç–∏ —è–∫—ñ—Å—Ç—å —Å–Ω—É.
6. –°–ø–æ–∂–∏–≤–∞–Ω–Ω—è –∫–æ—Ñ–µ—ó–Ω—É:

  - –°–ø–æ–∂–∏–≤–∞–Ω–Ω—è –∫–æ—Ñ–µ—ó–Ω—É —Ç–∞–∫–æ–∂ –≤–ø–ª–∏–≤–∞—î –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Å–Ω—É, —Ö–æ—á–∞ —ñ –≤ –º–µ–Ω—à—ñ–π –º—ñ—Ä—ñ –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ —ñ–Ω—à–∏–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏. –í—ñ–¥–æ–º–æ, —â–æ –∫–æ—Ñ–µ—ó–Ω –º–æ–∂–µ –≤–ø–ª–∏–≤–∞—Ç–∏ –Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –∑–∞—Å–∏–Ω–∞—Ç–∏ —Ç–∞ —è–∫—ñ—Å—Ç—å —Å–Ω—É.

### –í–∏—Å–Ω–æ–≤–∫–∏ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É —Ç–∞ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ:
1. –§–æ–∫—É—Å –Ω–∞ —Ñ—ñ–∑—ñ–æ–ª–æ–≥—ñ—á–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö:

  - –û—Å–∫—ñ–ª—å–∫–∏ —Ñ—ñ–∑—ñ–æ–ª–æ–≥—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Å–Ω—É –º–∞—é—Ç—å –Ω–∞–π–±—ñ–ª—å—à–∏–π –≤–ø–ª–∏–≤, –ø–æ–¥–∞–ª—å—à–∏–π –∞–Ω–∞–ª—ñ–∑ —Ç–∞ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Å–ø—Ä—è–º–æ–≤–∞–Ω—ñ –Ω–∞ –ø–æ–≥–ª–∏–±–ª–µ–Ω–µ –≤–∏–≤—á–µ–Ω–Ω—è —Ü–∏—Ö —Ñ–∞–∫—Ç–æ—Ä—ñ–≤.
2. –ê–Ω–∞–ª—ñ–∑ –≤–ø–ª–∏–≤—É —à–∫—ñ–¥–ª–∏–≤–∏—Ö –∑–≤–∏—á–æ–∫ —Ç–∞ —Ñ—ñ–∑–∏—á–Ω–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ:

  - –†–µ—Ç–µ–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –≤–ø–ª–∏–≤—É –≤–∂–∏–≤–∞–Ω–Ω—è –∞–ª–∫–æ–≥–æ–ª—é, –ø–∞–ª—ñ–Ω–Ω—è —Ç–∞ —Ñ—ñ–∑–∏—á–Ω–∏—Ö –≤–ø—Ä–∞–≤ –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ —Ä–æ–∑—Ä–æ–±–∏—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ —Å–Ω—É.
3. –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–º–µ–Ω—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä–Ω–æ—Å—Ç—ñ:

  - –ó–æ—Å–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –Ω–∞ –Ω–∞–π–±—ñ–ª—å—à –≤–∞–∂–ª–∏–≤–∏—Ö –æ–∑–Ω–∞–∫–∞—Ö –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–º–µ–Ω—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ, —â–æ –º–æ–∂–µ —Å–ø—Ä–æ—Å—Ç–∏—Ç–∏ —ó—ó —Ç–∞ –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –±–µ–∑ –∑–Ω–∞—á–Ω–æ—ó –≤—Ç—Ä–∞—Ç–∏ —Ç–æ—á–Ω–æ—Å—Ç—ñ.
4. –†–æ–∑—Ä–æ–±–∫–∞ —ñ–Ω—Ç–µ—Ä–≤–µ–Ω—Ü—ñ–π:

  - –í—Ä–∞—Ö–æ–≤—É—é—á–∏ –≤–∞–∂–ª–∏–≤—ñ—Å—Ç—å —Ä—ñ–∑–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä—ñ–≤, –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Ç–∞ —ñ–Ω—Ç–µ—Ä–≤–µ–Ω—Ü—ñ—ó –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ —Å–Ω—É, –∑–æ–∫—Ä–µ–º–∞ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –≤—ñ–∫–æ–≤–∏—Ö –≥—Ä—É–ø –∞–±–æ –ª—é–¥–µ–π –∑ –ø–µ–≤–Ω–∏–º–∏ —à–∫—ñ–¥–ª–∏–≤–∏–º–∏ –∑–≤–∏—á–∫–∞–º–∏.

# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è sns.pairplot(df) –¥–ª—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ä–æ–∑–ø–æ–¥—ñ–ª—É –¥–∞–Ω–∏—Ö —ñ –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—ñ–≤ –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏
"""

# –ü–æ–±—É–¥–æ–≤–∞ pairplot –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—ñ–≤ –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏
sns.pairplot(df)
plt.show()

# –í–∏–±—ñ—Ä –∫—ñ–ª—å–∫–æ—Ö –∫–ª—é—á–æ–≤–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö
selected_columns = ['Sleep efficiency', 'Sleep duration', 'Age', 'Awakenings', 'Caffeine consumption', 'Alcohol consumption']

# –ü–æ–±—É–¥–æ–≤–∞ pairplot –¥–ª—è –≤–∏–±—Ä–∞–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö
sns.pairplot(df[selected_columns])
plt.show()

"""## –°–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:
1. –ö–æ—Ä–µ–ª—è—Ü—ñ—è –º—ñ–∂ "Sleep efficiency" —Ç–∞ "Sleep duration":
  - –Ñ –ø–µ–≤–Ω–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è –º—ñ–∂ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—é —Å–Ω—É —ñ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é —Å–Ω—É. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –∑—ñ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è–º —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ —Å–Ω—É –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Å–Ω—É —Ç–∞–∫–æ–∂ –º–∞—î —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—é –∑–±—ñ–ª—å—à—É–≤–∞—Ç–∏—Å—å.
2. –ö–æ—Ä–µ–ª—è—Ü—ñ—è –º—ñ–∂ "Sleep efficiency" —Ç–∞ "Age":

  - –ú–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏ —Å–ª–∞–±–∫—É –∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—é –∫–æ—Ä–µ–ª—è—Ü—ñ—é –º—ñ–∂ –≤—ñ–∫–æ–º —ñ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é —Å–Ω—É.
3. –ö–æ—Ä–µ–ª—è—Ü—ñ—è –º—ñ–∂ "Sleep efficiency" —Ç–∞ "Awakenings":

  - –Ñ –Ω–µ–≥–∞—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è –º—ñ–∂ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –ø—Ä–æ–±—É–¥–∂–µ–Ω—å —ñ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é —Å–Ω—É. –ß–∏–º –±—ñ–ª—å—à–µ –ø—Ä–æ–±—É–¥–∂–µ–Ω—å –ø—ñ–¥ —á–∞—Å —Å–Ω—É, —Ç–∏–º –Ω–∏–∂—á–∞ –π–æ–≥–æ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.
4. –ö–æ—Ä–µ–ª—è—Ü—ñ—è –º—ñ–∂ "Sleep efficiency" —Ç–∞ "Caffeine consumption":

  - –í—ñ–¥—Å—É—Ç–Ω—è –∞–±–æ –¥—É–∂–µ —Å–ª–∞–±–∫–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è –º—ñ–∂ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è–º –∫–æ—Ñ–µ—ó–Ω—É —ñ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é —Å–Ω—É. –ú–æ–∂–ª–∏–≤–æ, —î —ñ–Ω—à—ñ —Ñ–∞–∫—Ç–æ—Ä–∏, —è–∫—ñ –∫–æ–º–ø–µ–Ω—Å—É—é—Ç—å –≤–ø–ª–∏–≤ –∫–æ—Ñ–µ—ó–Ω—É –Ω–∞ —Å–æ–Ω.
5. –ö–æ—Ä–µ–ª—è—Ü—ñ—è –º—ñ–∂ "Sleep efficiency" —Ç–∞ "Alcohol consumption":

  - –í—ñ–¥—Å—É—Ç–Ω—è –∞–±–æ –¥—É–∂–µ —Å–ª–∞–±–∫–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è –º—ñ–∂ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è–º –∞–ª–∫–æ–≥–æ–ª—é —ñ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é —Å–Ω—É.

## –í–∏—Å–Ω–æ–≤–∫–∏:
1. –û—Å–Ω–æ–≤–Ω—ñ —Ñ–∞–∫—Ç–æ—Ä–∏, —â–æ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Å–Ω—É:

  - –ù–∞–π—Å–∏–ª—å–Ω—ñ—à—ñ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –º—ñ–∂ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é —Å–Ω—É —Ç–∞ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—é —Å–Ω—É, –∞ —Ç–∞–∫–æ–∂ –º—ñ–∂ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é —Å–Ω—É —ñ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –ø—Ä–æ–±—É–¥–∂–µ–Ω—å. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Ü—ñ –¥–≤–∞ —Ñ–∞–∫—Ç–æ—Ä–∏ —î –Ω–∞–π–±—ñ–ª—å—à –∑–Ω–∞—á—É—â–∏–º–∏ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Å–Ω—É.
  - –í—ñ–∫, —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –∫–æ—Ñ–µ—ó–Ω—É —Ç–∞ –∞–ª–∫–æ–≥–æ–ª—é –º–∞—é—Ç—å –º–µ–Ω—à–∏–π –≤–ø–ª–∏–≤ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Å–Ω—É –≤ —Ü—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ.
2. –ü–æ—Ä–∞–¥–∏ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Å–Ω—É:

  - –©–æ–± –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Å–Ω—É, –≤–∞—Ä—Ç–æ –∑–≤–µ—Ä–Ω—É—Ç–∏ —É–≤–∞–≥—É –Ω–∞ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ —Å–Ω—É —Ç–∞ –∑–º–µ–Ω—à–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø—Ä–æ–±—É–¥–∂–µ–Ω—å.
3. –ü–æ–¥–∞–ª—å—à—ñ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è:

  - –ú–æ–∂–ª–∏–≤–æ, –≤–∞—Ä—Ç–æ –¥–æ—Å–ª—ñ–¥–∏—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ–∞–∫—Ç–æ—Ä–∏, —è–∫—ñ –Ω–µ –±—É–ª–∏ –≤–∫–ª—é—á–µ–Ω—ñ –≤ —Ü–µ–π –∞–Ω–∞–ª—ñ–∑, –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω—ñ –º–æ–¥–µ–ª—ñ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—ñ–≤ –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏.

#### –¶—ñ –≤–∏—Å–Ω–æ–≤–∫–∏ –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ –≤—ñ–∑—É–∞–ª—å–Ω–æ–º—É –∞–Ω–∞–ª—ñ–∑—ñ –ø–∞—Ä–Ω–∏—Ö –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ —ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω—ñ –∞–±–æ —Å–ø—Ä–æ—Å—Ç–æ–≤–∞–Ω—ñ –ø–æ–¥–∞–ª—å—à–∏–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–º–∏ –∞–Ω–∞–ª—ñ–∑–∞–º–∏ –∞–±–æ –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏.

## –ì—Ä–∞—Ñ—ñ–∫ –∑–∞–ª–∏—à–∫—ñ–≤ (residuals plot).
"""

# –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ
y_pred = grid_search_rf.best_estimator_.predict(X_test)

# –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–ª–∏—à–∫—ñ–≤
residuals = y_test - y_pred

# –ü–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ—ñ–∫—É –∑–∞–ª–∏—à–∫—ñ–≤
plt.figure(figsize=(10, 6))
plt.scatter(y_pred, residuals, alpha=0.5)
plt.axhline(y=0, color='r', linestyle='--')
plt.title('Residuals Plot')
plt.xlabel('Predicted Values')
plt.ylabel('Residuals')
plt.show()

"""###–°–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:
1. –†–æ–∑–ø–æ–¥—ñ–ª –∑–∞–ª–∏—à–∫—ñ–≤:

  - –ó–∞–ª–∏—à–∫–∏ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ –Ω–∞–≤–∫–æ–ª–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ—ó –ª—ñ–Ω—ñ—ó y=0. –¶–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ –º–æ–¥–µ–ª—å –≤ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É –Ω–µ –º–∞—î —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫ —É –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—ñ. –Ø–∫—â–æ –∑–∞–ª–∏—à–∫–∏ —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ –Ω–∞–≤–∫–æ–ª–æ –Ω—É–ª—è, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –º–æ–¥–µ–ª—å –Ω–µ –º–∞—î –∑–Ω–∞—á–Ω–∏—Ö –∑—Å—É–≤—ñ–≤ —É –±—ñ–∫ –ø–µ—Ä–µ–æ—Ü—ñ–Ω–∫–∏ –∞–±–æ –Ω–µ–¥–æ–æ—Ü—ñ–Ω–∫–∏.
2. –ì–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å:

  - –Ø–∫—â–æ –∑–∞–ª–∏—à–∫–∏ —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ —ñ –Ω–µ —É—Ç–≤–æ—Ä—é—é—Ç—å —á—ñ—Ç–∫–∏—Ö –≤—ñ–∑–µ—Ä—É–Ω–∫—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–æ—Ä–æ–Ω–∫–∏ –∞–±–æ —ñ–Ω—à–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä), —Ü–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å (–ø–æ—Å—Ç—ñ–π–Ω–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è –ø–æ–º–∏–ª–æ–∫). –ì–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å —î –±–∞–∂–∞–Ω–æ—é –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—é, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ –º–æ–¥–µ–ª—å –ø—Ä–∞—Ü—é—î —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–æ –¥–ª—è –≤—Å—ñ—Ö –∑–Ω–∞—á–µ–Ω—å —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó.
3. –ù–∞—è–≤–Ω—ñ—Å—Ç—å —Ç—Ä–µ–Ω–¥—ñ–≤:

  - –Ø–∫—â–æ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É –∑–∞–ª–∏—à–∫—ñ–≤ –Ω–µ–º–∞—î —á—ñ—Ç–∫–æ –≤–∏–¥–∏–º–∏—Ö —Ç—Ä–µ–Ω–¥—ñ–≤ –∞–±–æ —Å—Ç—Ä—É–∫—Ç—É—Ä, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –º–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—Ä–∞—Ö—É–≤–∞–ª–∞ –≤—Å—ñ –ª—ñ–Ω—ñ–π–Ω—ñ —Ç–∞ –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏. –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –≤–∏–¥–∏–º–∏—Ö —Ç—Ä–µ–Ω–¥—ñ–≤ –≤ –∑–∞–ª–∏—à–∫–∞—Ö —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ –º–æ–¥–µ–ª—å –¥–æ–±—Ä–µ —Å–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –∑ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è–º.

###–í–∏—Å–Ω–æ–≤–∫–∏:
1. –Ø–∫—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ:

  - –ú–æ–¥–µ–ª—å –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Å—É, –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é GridSearchCV, –¥–æ–±—Ä–µ –ø—Ä–æ–≥–Ω–æ–∑—É—î —Ü—ñ–ª—å–æ–≤—É –∑–º—ñ–Ω–Ω—É "Sleep efficiency". –†–æ–∑–ø–æ–¥—ñ–ª –∑–∞–ª–∏—à–∫—ñ–≤ –Ω–∞–≤–∫–æ–ª–æ –Ω—É–ª—è –±–µ–∑ –≤–∏–¥–∏–º–∏—Ö —Ç—Ä–µ–Ω–¥—ñ–≤ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ –º–æ–¥–µ–ª—å –Ω–µ –º–∞—î –∑–Ω–∞—á–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫ —ñ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—Ä–∞—Ö–æ–≤—É—î –æ—Å–Ω–æ–≤–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤ –¥–∞–Ω–∏—Ö.
2. –ü—Ä–æ–±–ª–µ–º–∏ –≤ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—ñ:

  - –Ø–∫—â–æ –±—É–ª–∏ –± –≤–∏—è–≤–ª–µ–Ω—ñ —á—ñ—Ç–∫—ñ —Ç—Ä–µ–Ω–¥–∏ –∞–±–æ –≤—ñ–∑–µ—Ä—É–Ω–∫–∏ –≤ –∑–∞–ª–∏—à–∫–∞—Ö, —Ü–µ –º–æ–≥–ª–æ –± —Å–≤—ñ–¥—á–∏—Ç–∏ –ø—Ä–æ —Ç–µ, —â–æ –º–æ–¥–µ–ª—å –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∞ —è–∫—É—Å—å –≤–∞–∂–ª–∏–≤—É –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –∞–±–æ —â–æ —î –ø—Ä–æ–±–ª–µ–º–∏ –∑ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—é. –û–¥–Ω–∞–∫ —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ç–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º –Ω–µ –≤–∏—è–≤–ª–µ–Ω–æ.
3. –ü–æ–¥–∞–ª—å—à—ñ –∫—Ä–æ–∫–∏:

  - –ú–æ–∂–Ω–∞ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –º–µ—Ç–æ–¥–∏ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∫–ª—é—á–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –æ–∑–Ω–∞–∫ –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è. –û–¥–Ω–∞–∫ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≥—Ä–∞—Ñ—ñ–∫—É –∑–∞–ª–∏—à–∫—ñ–≤ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –≤–∏—Å–Ω–æ–≤–æ–∫, —â–æ –º–æ–¥–µ–ª—å –≤–∂–µ –¥–æ—Å–∏—Ç—å –¥–æ–±—Ä–µ —Å–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –∑—ñ —Å–≤–æ—ó–º –∑–∞–≤–¥–∞–Ω–Ω—è–º.

####–¶—ñ –≤–∏—Å–Ω–æ–≤–∫–∏ –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ –≤—ñ–∑—É–∞–ª—å–Ω–æ–º—É –∞–Ω–∞–ª—ñ–∑—ñ –≥—Ä–∞—Ñ—ñ–∫—É –∑–∞–ª–∏—à–∫—ñ–≤ —ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω—ñ –∞–±–æ —Å–ø—Ä–æ—Å—Ç–æ–≤–∞–Ω—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–º–∏ —Ç–µ—Å—Ç–∞–º–∏ –∞–±–æ —ñ–Ω—à–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –∞–Ω–∞–ª—ñ–∑—É.
"""